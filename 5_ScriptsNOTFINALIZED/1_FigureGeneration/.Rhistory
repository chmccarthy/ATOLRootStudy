size_label = sprintf("%s unique genes\n%s core genes\n%s accessory genes",
core + accessory, core, accessory)
## Generate ring chart plot.
p1 = ggplot(ring, aes(fill=category, ymax=ymax, ymin=ymin, xmax=4, xmin=3)) +
geom_rect(stat="identity", color='black') +
coord_polar(theta="y") +
xlim(c(0, 5)) +
annotate("text", x = 0, y = 0, label = size_label) +
labs(title="") +
geom_label_repel(aes(label=paste(category, "\n",round(fraction*100, digits = 2),"%"), x=4 ,y=(ymin+ymax)/2), nudge_x = 2, arrow = arrow(angle = 0, length = unit(0.01, 'npc')), inherit.aes = FALSE, show.legend = FALSE, direction="both", max.iter = 3e3, ylim=c(6,8)) +
guides(fill=guide_legend(reverse = TRUE, override.aes=list(colour=NA))) +
scale_fill_manual(values = pal) +
theme_void() +
theme(legend.position="top", legend.title = element_text(face="bold")) +
labs(fill = "Component")
## Write ring chart to file and close.
p1
#dev.off()
options(device)
options("device")
x11(type="cairo")
install.packages("Cairo")
install.packages("Cairo")
library(Cario)
library(Cairo)
knitr::opts_chunk$set(echo = FALSE)
summary(cars)
plot(pressure)
##Normal log likelihood estimation of mu.
X<-c(11.2,10.8,9.0,12.4,12.1,10.3,10.4,10.6,9.3,11.8)
mean(X)
possibilities.mu<-seq(8,14,.01)
loglik.norm.plot(X,parameter="mu",possibilities.mu)
##
## Example plotting GARPFYMINK tree, re-rooting and then plotting with
## edge-lengths set to b value
##
## Should copy the functions from gfmix after the first line `##----..' and
## before the next instance of  `##----..' to a file garp-mix-fns.q
## Should move the following to garp-mix-fns.q
aal <- c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F",
"P", "S", "T", "W", "Y", "V")
aall <- c("a", "r", "n", "d", "c", "q", "e", "g", "h", "i", "l", "k", "m", "f",
"p", "s", "t", "w", "y", "v")
source("~/bin/garp-mix-fns.q")
source("~/bin/treefns.q")
## To create utreec file (tree format I use) use the following
## The program treecns is part of the gfmix packaged software.
## You may need to change this to include the full path name for treecns
cmd <- "treecns"
treefile <- "RP_constrained_0.2.treefile"
seqfile <- "../RP_Eurys+Nanohalo_bmge_0.2.fasta_INT.phy"
system(paste(cmd,treefile,"GARPFYMINK.utreec -1 <",seqfile," >GARPFYMINK.names"))
## Plot the GARPFYMINK tree
utreec <- matrix(scan("GARPFYMINK.utreec",quiet=TRUE),ncol=4,byrow=TRUE)
names <- scan("GARPFYMINK.names",quiet=TRUE,what=character())
utreedraw(utreec,names,blabel=TRUE)
## The label of the branch with the root is 42. Add 1 to it and reroot
utreec <- rertnutreec(35,utreec)
utreedraw(utreec,names,blabel=TRUE)
## Plot the tree with b values as labels. Taxa are relabeled in HierH. Might
## want to change this.
l <- HierH(utreec,seqfile=seqfile,H=GF,g=c("G","A","R","P"),
f=c("F","Y","M","I","N","K"))
utreedraw(l$utreec,names=l$blabel,blabel=TRUE,labels=l$blabel)
cwd()
pwd()
# generate plots of CAT-fixed category mixture models
# raw data from iqtree
# http://www.iqtree.org/doc/Substitution-Models#protein-models
#  A   R   N   D   C   Q   E   G   H   I   L   K   M   F   P   S   T   W   Y   V
# Ala Arg Asn Asp Cys Gln Glu Gly His Ile Leu Lys Met Phe Pro Ser Thr Trp Tyr Val
# AAs in alphabetic order
aalist = c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
# colors from sand to deep red
colset = c("#ffffb2", "#ffeda0", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026", "#dd1c77",  "#660821")
# data from https://www.sigmaaldrich.com/life-science/metabolomics/learning-center/amino-acid-reference-chart.html
# which itself derives from:
# Relationship of sidechain hydrophobicity and a‐helical propensity on the stability of the single‐stranded amphipathic a‐helix
# https://doi.org/10.1002/psc.310010507
hydrophobicity = c(41,-14,-28,-55,49,-10,-31,0,8,99,97,-23,74,100,-46,-5,13,96,63,76)
# sort and return index, which will reorder from hydrophilic (Asp) to most hydrophobic (Phe)
s_hyd = sort(hydrophobicity, index.return=TRUE)
C60pi1 = c(0.1534363248,0.0444389067,0.0796726990,0.0546757288,0.0047306596,0.0514333025,0.0529324359,0.1103775749,0.0174480218,0.0050343887,0.0130294160,0.0603928711,0.0075550589,0.0035554315,0.0249523704,0.2029625968,0.0957668473,0.0014444483,0.0059800307,0.0101808864)
C60pi2 = c(0.0281984692,0.3031055487,0.0312954609,0.0091549350,0.0019503463,0.0939884393,0.0388530140,0.0084028325,0.0155384715,0.0107872879,0.0217786594,0.3476042929,0.0109904917,0.0015919288,0.0071539896,0.0197479052,0.0328352333,0.0009209994,0.0025714024,0.0135302919)
C60pi3 = c(0.0083680740,0.0007319768,0.0006123446,0.0002228366,0.0020433870,0.0009498685,0.0004731544,0.0004825748,0.0005189995,0.3768453098,0.2608334606,0.0006296168,0.0315700586,0.0123984358,0.0009595916,0.0009746383,0.0049990761,0.0008657759,0.0017132332,0.2938075872)
C60pi4 = c(0.2227229348,0.0064846074,0.0061206496,0.0007997588,0.1640285908,0.0051051888,0.0027280806,0.0202702520,0.0037183875,0.0455406072,0.0883350071,0.0022832871,0.0348094559,0.0228667054,0.0035471579,0.0850040072,0.1012848285,0.0048424833,0.0096500033,0.1698580069)
C60pi5 = c(0.0412139519,0.0067627055,0.0051067690,0.0017434391,0.0204715649,0.0057538477,0.0037263409,0.0069107492,0.0180293946,0.1154281623,0.1693562458,0.0042900270,0.0414066566,0.2239001858,0.0058416410,0.0149106129,0.0239548406,0.0332237129,0.1379349474,0.1200342049)
C60pi6 = c(0.0480550249,0.0308438053,0.0940628721,0.2084606133,0.0037801787,0.0747676701,0.1855184661,0.0191402239,0.0872162350,0.0094685435,0.0277340828,0.0375741243,0.0088308358,0.0196000958,0.0081267777,0.0439680761,0.0324588883,0.0034665720,0.0387499964,0.0181769181)
C60pi7 = c(0.0062848745,0.0026246919,0.0030342510,0.0005324147,0.0073027627,0.0034409089,0.0009741492,0.0019578159,0.0102225186,0.0180592309,0.1179064681,0.0016205916,0.0234721825,0.3974552519,0.0020165583,0.0056903327,0.0037091821,0.0598639097,0.3185565304,0.0152753744)
C60pi8 = c(0.1815005560,0.0026845411,0.0148484537,0.0025145485,0.4205633920,0.0014097001,0.0007088144,0.0461854175,0.0014374605,0.0041745536,0.0098310464,0.0006474254,0.0041611385,0.0068976432,0.0038767247,0.1864537050,0.0687189855,0.0027083549,0.0061033012,0.0345742379)
C60pi9 = c(0.0600740822,0.0367642654,0.0134869242,0.0170572285,0.0070719770,0.0142469806,0.0127486975,0.0343564471,0.0305859029,0.0204571345,0.0994551128,0.0212367087,0.0318165939,0.1140907926,0.0297628218,0.0505792699,0.0339368402,0.2312808862,0.1192491702,0.0217421638)
C60pi10 = c(0.0708394513,0.0474098489,0.0416822304,0.0324482918,0.0131641265,0.0494874703,0.0508264389,0.0183309196,0.0567272697,0.0650369079,0.1282255556,0.0343618389,0.0390362930,0.0594359563,0.0135608209,0.0551343199,0.0642260358,0.0137118382,0.0673934289,0.0789609573)
C60pi11 = c(0.0617689371,0.0076332888,0.0303081645,0.3430234188,0.0007199837,0.0307856241,0.3792509407,0.0284658686,0.0079592120,0.0016999627,0.0039945339,0.0216076877,0.0019734329,0.0009814186,0.0174791407,0.0337831940,0.0203426591,0.0006130268,0.0017102752,0.0058992300)
C60pi12 = c(0.0421559537,0.1042068314,0.0286980872,0.0164385240,0.0044450330,0.1393690851,0.0531949072,0.0134711207,0.0177764997,0.0267727728,0.1967237776,0.1323735242,0.1182827521,0.0086728324,0.0051837880,0.0255852718,0.0333292020,0.0045852327,0.0070281498,0.0217066546)
C60pi13 = c(0.2814809927,0.0100367066,0.0172867775,0.0064385734,0.0258337508,0.0133101925,0.0115046410,0.0270054934,0.0054629657,0.0188216093,0.0190993462,0.0098712843,0.0158719589,0.0050481705,0.0129510033,0.1886808600,0.2427104979,0.0012274627,0.0036052922,0.0837524211)
C60pi14 = c(0.2769188320,0.0017226995,0.0021315271,0.0011672545,0.0318292645,0.0018216251,0.0024752467,0.0199646887,0.0005170863,0.0983109006,0.0489264326,0.0016232163,0.0173414948,0.0070843906,0.0070179705,0.0336348952,0.0814141404,0.0007118144,0.0032942319,0.3620922883)
C60pi15 = c(0.1577797792,0.1112140270,0.0570403237,0.0648290471,0.0053318076,0.1065373681,0.0913586945,0.0906209718,0.0533809635,0.0029171632,0.0156225571,0.0782148712,0.0045758969,0.0025047816,0.0067077844,0.0929310045,0.0393122597,0.0028575821,0.0077590269,0.0085040899)
C60pi16 = c(0.0593735135,0.0354740772,0.1151175314,0.2189482708,0.0015332173,0.0688752402,0.1819422913,0.0813707101,0.0220478285,0.0020993577,0.0056191259,0.0750172075,0.0021871739,0.0010838321,0.0109737422,0.0726449461,0.0380238271,0.0007346460,0.0026664883,0.0042669729)
C60pi17 = c(0.0978066326,0.0265576438,0.0101843505,0.0120781428,0.0064138404,0.0307876446,0.0291282947,0.0128912798,0.0128036716,0.0723904209,0.1279438950,0.0245630658,0.0303267312,0.0198963719,0.2723524069,0.0350549441,0.0484557340,0.0046842467,0.0104773833,0.1152032995)
C60pi18 = c(0.0124023388,0.0030680354,0.0009239105,0.0006037316,0.0041885695,0.0032957441,0.0012524000,0.0011306791,0.0013542104,0.2344167852,0.4550557697,0.0016718177,0.0667307666,0.0610615367,0.0037076169,0.0019420934,0.0067612939,0.0038937184,0.0074911765,0.1290478057)
C60pi19 = c(0.0794230623,0.1294739355,0.0662792725,0.0587236242,0.0019919499,0.1143880588,0.1246900644,0.0325432311,0.0238605372,0.0036277150,0.0097987961,0.2147597316,0.0041846209,0.0012869951,0.0142410239,0.0615807386,0.0477333594,0.0006525371,0.0029420233,0.0078187231)
C60pi20 = c(0.0248148778,0.0083552910,0.1888915388,0.4278832998,0.0027839717,0.0210777725,0.1432386297,0.0643968435,0.0185736870,0.0022506941,0.0034558626,0.0179274104,0.0015714503,0.0014680353,0.0073768035,0.0377003132,0.0187767966,0.0005891859,0.0042602708,0.0046072655)
C60pi21 = c(0.0017003427,0.0060674330,0.0004222900,0.0010711490,0.0029059420,0.0016424179,0.0011731741,0.0035579609,0.0027630465,0.0012291190,0.0127420810,0.0004273804,0.0025671348,0.0513377024,0.0013536738,0.0011871674,0.0014033068,0.8640436936,0.0390912582,0.0033137266)
C60pi22 = c(0.0468360682,0.0639796924,0.0205603686,0.0185615516,0.0059954138,0.0557030821,0.0705436036,0.0045435329,0.0152062773,0.1550613356,0.0824253382,0.0866248354,0.0245854443,0.0080177192,0.0081485616,0.0237025617,0.0962054496,0.0018368673,0.0067131723,0.2047491243)
C60pi23 = c(0.0258764792,0.0201097124,0.0298384107,0.0107037437,0.0142503909,0.0158529432,0.0105649532,0.0073064999,0.1411078834,0.0114777629,0.0407992414,0.0119179202,0.0098798997,0.1876429961,0.0051228805,0.0275699644,0.0170764901,0.0405124999,0.3536390834,0.0187502449)
C60pi24 = c(0.0296285022,0.0046400334,0.0034944393,0.0008851024,0.0090046468,0.0055481111,0.0033046518,0.0027969482,0.0050701500,0.2583397750,0.2668085481,0.0046690936,0.0770825277,0.0408798247,0.0026918193,0.0068538089,0.0322265673,0.0035506055,0.0153353414,0.2271895033)
C60pi25 = c(0.0555725806,0.0098447861,0.0409064430,0.0140389597,0.0097418602,0.0068727710,0.0069443190,0.0157956555,0.0041631258,0.0069826497,0.0075271247,0.0139224817,0.0058762687,0.0034496730,0.0119733364,0.3482466393,0.4213655981,0.0010061491,0.0026576772,0.0131119012)
C60pi26 = c(0.0682671212,0.0615207091,0.0530661192,0.0360278709,0.0141433148,0.0612274332,0.0497415394,0.0268696520,0.1127674983,0.0132646615,0.0544493838,0.0482609047,0.0170033964,0.0803375967,0.0191949850,0.0671839752,0.0443995774,0.0199957919,0.1255070748,0.0267713947)
C60pi27 = c(0.0792618808,0.0638377192,0.0635289371,0.0436646174,0.0049503302,0.0666365188,0.0829639117,0.0183428565,0.0233169239,0.0249427251,0.0221483402,0.0932577596,0.0120893380,0.0049131149,0.0126360122,0.1334848656,0.1916745928,0.0018040086,0.0062353115,0.0503102360)
C60pi28 = c(0.0731759112,0.2105335985,0.0324200854,0.0110007149,0.0123458504,0.0858951989,0.0349942684,0.0224509173,0.0386903280,0.0246226304,0.0508307349,0.1783344831,0.0185740720,0.0093148787,0.0148722772,0.0603181436,0.0649574934,0.0051046395,0.0130597421,0.0385040321)
C60pi29 = c(0.0878402710,0.0110331750,0.0060801213,0.0032803903,0.0171147088,0.0109831614,0.0101465790,0.0087090941,0.0054902234,0.1987761871,0.1756460821,0.0082096925,0.0417232903,0.0191954435,0.0111283542,0.0209862621,0.0697718709,0.0031744014,0.0081905473,0.2825201446)
C60pi30 = c(0.0990215820,0.0349351987,0.0211149501,0.0118797946,0.0108995677,0.0557710676,0.0278999992,0.0240250097,0.0123445071,0.0776564721,0.2354511299,0.0322817789,0.1207665429,0.0214442058,0.0075655541,0.0524170141,0.0649785115,0.0047075806,0.0077328724,0.0771066610)
C60pi31 = c(0.0601641168,0.0161995226,0.2783522747,0.0337188808,0.0315066987,0.0210645987,0.0059839451,0.0543080710,0.0531523512,0.0070650825,0.0070698142,0.0139598368,0.0088298653,0.0069525877,0.0075834331,0.2829802556,0.0860317092,0.0014966551,0.0134849454,0.0100953553)
C60pi32 = c(0.0049781737,0.0018412331,0.0007012207,0.0005315368,0.0052978737,0.0024089907,0.0007630546,0.0015051317,0.0041575221,0.0443828633,0.4417417476,0.0011615060,0.0602807417,0.3351117140,0.0027847686,0.0025795769,0.0030288544,0.0171302592,0.0458455751,0.0237676560)
C60pi33 = c(0.0251996593,0.1114468110,0.0142031925,0.0041012288,0.0097099500,0.0620070749,0.0262571641,0.0038067269,0.0431938935,0.0974043253,0.2447197423,0.0824312856,0.0539323021,0.0429091639,0.0052658505,0.0096093107,0.0251183002,0.0146571900,0.0456965140,0.0783303143)
C60pi34 = c(0.0230361648,0.0014748749,0.0013534390,0.0006264439,0.0048580122,0.0009870046,0.0015762583,0.0011565336,0.0008899238,0.3952895890,0.0576537208,0.0014663528,0.0140986541,0.0072127040,0.0020177885,0.0028770237,0.0205580852,0.0005477695,0.0019539080,0.4603657493)
C60pi35 = c(0.1408776963,0.0297808449,0.0171297613,0.0285076933,0.0032213718,0.0320632225,0.0423838922,0.0299558472,0.0131321477,0.0066914481,0.0195120028,0.0383781635,0.0036276863,0.0041231064,0.4383466229,0.0851400095,0.0422765692,0.0013236871,0.0037087638,0.0198194632)
C60pi36 = c(0.4442491220,0.0050216551,0.0102305117,0.0057193038,0.0235405374,0.0055997640,0.0064889886,0.0822687710,0.0025505743,0.0033615104,0.0040990063,0.0038097073,0.0028683069,0.0024413211,0.0162890960,0.2999969708,0.0559664935,0.0007735426,0.0020639824,0.0226608347)
C60pi37 = c(0.0898717958,0.0070958305,0.0130067619,0.0129166888,0.0044131479,0.0023806547,0.0058957027,0.8087563021,0.0016517855,0.0004339282,0.0015564455,0.0033939025,0.0004253422,0.0008073572,0.0034128140,0.0362876891,0.0032887534,0.0015223902,0.0008537454,0.0020289624)
C60pi38 = c(0.0550840246,0.0472254260,0.1877829604,0.1273796123,0.0035824944,0.0527969268,0.0655884730,0.0637607521,0.0404883483,0.0075574152,0.0136304510,0.0867682792,0.0081684229,0.0040375032,0.0110681809,0.1263380956,0.0752544318,0.0013563681,0.0118590434,0.0102727908)
C60pi39 = c(0.0117681394,0.0442558806,0.0844144627,0.0144712108,0.0070388254,0.1038342049,0.0110901161,0.0049626578,0.4337194047,0.0061337038,0.0298794939,0.0137928558,0.0076237551,0.0338266335,0.0081346096,0.0140571089,0.0108276801,0.0080683065,0.1437251732,0.0083757773)
C60pi40 = c(0.0159285638,0.0048098656,0.0032692643,0.0010966937,0.0080519916,0.0134552459,0.0021324215,0.0025086365,0.0049192147,0.0501543893,0.5307634291,0.0035599431,0.2160085187,0.0743650717,0.0045247350,0.0066922196,0.0119092283,0.0070928134,0.0106565111,0.0281012433)
C60pi41 = c(0.0195973253,0.0105142992,0.3289103336,0.3099848991,0.0034539049,0.0116196758,0.0250777800,0.0627528956,0.0295961112,0.0032650434,0.0028246884,0.0240963907,0.0008425062,0.0019706550,0.0049062781,0.1064984500,0.0438053705,0.0006333959,0.0056197958,0.0040302013)
C60pi42 = c(0.0833804360,0.0125871438,0.0969824220,0.0686820704,0.0081981143,0.0121520930,0.0227415415,0.0982291876,0.0073954898,0.0017471177,0.0039653113,0.0129342146,0.0019557975,0.0024132583,0.0355924232,0.3115606483,0.2113368612,0.0016329034,0.0017991083,0.0047138579)
C60pi43 = c(0.0181409133,0.4129662563,0.0233205154,0.0033333547,0.0085143598,0.0526694251,0.0096531879,0.0224552642,0.0375238929,0.0035090482,0.0149146621,0.3208065790,0.0046098856,0.0035426859,0.0087197469,0.0262309419,0.0131791136,0.0034766995,0.0079588201,0.0044746474)
C60pi44 = c(0.2494227404,0.0185481724,0.0164119567,0.0169234299,0.0122862654,0.0228501981,0.0370491083,0.0347467705,0.0087069587,0.0595718359,0.0451065029,0.0177064733,0.0204556127,0.0077360919,0.0686403544,0.0889295672,0.0986017356,0.0028603862,0.0061938477,0.1672519917)
C60pi45 = c(0.1419737638,0.0373945961,0.0576296888,0.0537452477,0.0068856658,0.0286239972,0.0407540287,0.3988107872,0.0152895617,0.0016627616,0.0092348297,0.0314273807,0.0055425500,0.0040286132,0.0180328866,0.1123731997,0.0242478202,0.0025909098,0.0049054208,0.0048462908)
C60pi46 = c(0.0178903305,0.1958843646,0.0155853897,0.0031054277,0.0290304227,0.1051819261,0.0040503389,0.0100480293,0.1252696215,0.0016708003,0.0722356645,0.0233340169,0.0116142354,0.0238913260,0.0009938415,0.0181675536,0.0186260222,0.2260554691,0.0859787232,0.0113864962)
C60pi47 = c(0.1454758367,0.0420979067,0.0400419720,0.1294249748,0.0014186329,0.0906469055,0.2471353458,0.0319650773,0.0130426183,0.0058525371,0.0123593139,0.0818154090,0.0044178939,0.0017552077,0.0151135525,0.0656688174,0.0511289472,0.0007731441,0.0029258438,0.0169400635)
C60pi48 = c(0.0169799462,0.0242346701,0.1318047919,0.1043655101,0.0022087215,0.0269349684,0.0376379591,0.5404470183,0.0181137053,0.0007459679,0.0021146994,0.0508617611,0.0009473769,0.0006780593,0.0038754401,0.0297030159,0.0045836180,0.0006031889,0.0015704090,0.0015891728)
C60pi49 = c(0.0402646249,0.1152022601,0.0323829165,0.0293968352,0.0039388655,0.2497008043,0.1603524245,0.0129260411,0.0617967839,0.0098491259,0.0354918823,0.1448804422,0.0124818865,0.0041153375,0.0043374229,0.0243246958,0.0305645368,0.0026676598,0.0097227847,0.0156026694)
C60pi50 = c(0.2256914610,0.0523417493,0.0244308734,0.0637125217,0.0043390149,0.0578159236,0.1154830640,0.0867335173,0.0131066949,0.0085086217,0.0193314218,0.0660468804,0.0064877206,0.0027440054,0.0611149102,0.1070877179,0.0507677144,0.0013695913,0.0028982948,0.0299883012)
C60pi51 = c(0.0033164209,0.0015310773,0.0030830171,0.0008266472,0.0051890730,0.0011024889,0.0005134130,0.0010432830,0.0278451262,0.0041895268,0.0111212494,0.0007149922,0.0023621780,0.3801761447,0.0008365077,0.0035876698,0.0023608948,0.0333346985,0.5107889643,0.0060766272)
C60pi52 = c(0.1995014012,0.0236078675,0.0392254543,0.0094955104,0.0584590451,0.0254265363,0.0125535371,0.0939787338,0.0341857201,0.0140209879,0.0449387571,0.0118723304,0.0246990633,0.0634433944,0.0145385320,0.1663920640,0.0533159207,0.0129802666,0.0606346163,0.0367302614)
C60pi53 = c(0.0319448994,0.1011667268,0.2084709220,0.0378074649,0.0066040348,0.0766372935,0.0279488190,0.0365541130,0.2088643258,0.0047542347,0.0156545731,0.0868664783,0.0043253317,0.0108915768,0.0060899575,0.0577656939,0.0302051160,0.0026001883,0.0387897304,0.0060585202)
C60pi54 = c(0.0776799515,0.0142518583,0.0403216692,0.0080651725,0.0140092962,0.0179995517,0.0112622427,0.0136868237,0.0133729897,0.1239635380,0.0724670993,0.0129144967,0.0420745442,0.0173584908,0.0117084432,0.0922723571,0.2316899445,0.0028153633,0.0141726542,0.1679135132)
C60pi55 = c(0.1183662657,0.0805192606,0.0259524932,0.0495595439,0.0035624835,0.1204924917,0.1537589210,0.0194993426,0.0229373171,0.0302661211,0.0571250629,0.0982304112,0.0171727472,0.0068665705,0.0175153030,0.0486588400,0.0635796210,0.0023008307,0.0083027431,0.0553336300)
C60pi56 = c(0.0528559899,0.0193569043,0.0264743774,0.2092761515,0.0008625883,0.1212409715,0.4024189781,0.0155838458,0.0124148798,0.0054864832,0.0090256472,0.0497017031,0.0042357114,0.0012650715,0.0063185636,0.0197262901,0.0235463735,0.0008381610,0.0033948741,0.0159764347)
C60pi57 = c(0.0344366215,0.0426221820,0.1636716191,0.1139007491,0.0020985982,0.0605413987,0.0541780220,0.3361639671,0.0461776737,0.0003463416,0.0048355678,0.0667552967,0.0019704509,0.0031557619,0.0040369775,0.0481173332,0.0089148085,0.0006510101,0.0054145649,0.0020110555)
C60pi58 = c(0.1153088951,0.0151278638,0.0458476603,0.1755516676,0.0014962362,0.0366731222,0.1749410045,0.0394181311,0.0132401530,0.0056912974,0.0101409559,0.0433118387,0.0030332064,0.0015700232,0.1665802563,0.0871536033,0.0468260603,0.0007515702,0.0031432715,0.0141931831)
C60pi59 = c(0.3865149348,0.0037579334,0.0030420497,0.0022366810,0.0218928357,0.0021464743,0.0031387843,0.3694353983,0.0014672902,0.0085376076,0.0127257242,0.0018840458,0.0080581695,0.0039281367,0.0158688291,0.0808877279,0.0305195935,0.0009922880,0.0019020345,0.0410634615)
C60pi60 = c(0.0146570745,0.0028841333,0.0012998335,0.0005210575,0.0024317913,0.0049362750,0.0014874369,0.0020953252,0.0010181940,0.1913901476,0.4432797758,0.0022898369,0.2217427062,0.0091637503,0.0007685153,0.0027251487,0.0170997497,0.0008779380,0.0014756028,0.0778557075)
catlist = cbind(C60pi1,C60pi2,C60pi3,C60pi4,C60pi5,C60pi6,C60pi7,C60pi8,C60pi9,C60pi10, C60pi11,C60pi12,C60pi13,C60pi14,C60pi15,C60pi16,C60pi17,C60pi18,C60pi19,C60pi20, C60pi21,C60pi22,C60pi23,C60pi24,C60pi25,C60pi26,C60pi27,C60pi28,C60pi29,C60pi30, C60pi31,C60pi32,C60pi33,C60pi34,C60pi35,C60pi36,C60pi37,C60pi38,C60pi39,C60pi40, C60pi41,C60pi42,C60pi43,C60pi44,C60pi45,C60pi46,C60pi47,C60pi48,C60pi49,C60pi50, C60pi51,C60pi52,C60pi53,C60pi54,C60pi55,C60pi56,C60pi57,C60pi58,C60pi59,C60pi60)
View(catlist)
# generate plots of CAT-fixed category mixture models
# raw data from iqtree
# http://www.iqtree.org/doc/Substitution-Models#protein-models
#  A   R   N   D   C   Q   E   G   H   I   L   K   M   F   P   S   T   W   Y   V
# Ala Arg Asn Asp Cys Gln Glu Gly His Ile Leu Lys Met Phe Pro Ser Thr Trp Tyr Val
# AAs in alphabetic order
aalist = c("A", "R", "N", "D", "C", "Q", "E", "G", "H", "I", "L", "K", "M", "F", "P", "S", "T", "W", "Y", "V")
# colors from sand to deep red
colset = c("#ffffb2", "#ffeda0", "#fecc5c", "#fd8d3c", "#f03b20", "#bd0026", "#dd1c77",  "#660821")
# data from https://www.sigmaaldrich.com/life-science/metabolomics/learning-center/amino-acid-reference-chart.html
# which itself derives from:
# Relationship of sidechain hydrophobicity and a‐helical propensity on the stability of the single‐stranded amphipathic a‐helix
# https://doi.org/10.1002/psc.310010507
hydrophobicity = c(41,-14,-28,-55,49,-10,-31,0,8,99,97,-23,74,100,-46,-5,13,96,63,76)
# sort and return index, which will reorder from hydrophilic (Asp) to most hydrophobic (Phe)
s_hyd = sort(hydrophobicity, index.return=TRUE)
C60pi1 = c(0.1534363248,0.0444389067,0.0796726990,0.0546757288,0.0047306596,0.0514333025,0.0529324359,0.1103775749,0.0174480218,0.0050343887,0.0130294160,0.0603928711,0.0075550589,0.0035554315,0.0249523704,0.2029625968,0.0957668473,0.0014444483,0.0059800307,0.0101808864)
C60pi2 = c(0.0281984692,0.3031055487,0.0312954609,0.0091549350,0.0019503463,0.0939884393,0.0388530140,0.0084028325,0.0155384715,0.0107872879,0.0217786594,0.3476042929,0.0109904917,0.0015919288,0.0071539896,0.0197479052,0.0328352333,0.0009209994,0.0025714024,0.0135302919)
C60pi3 = c(0.0083680740,0.0007319768,0.0006123446,0.0002228366,0.0020433870,0.0009498685,0.0004731544,0.0004825748,0.0005189995,0.3768453098,0.2608334606,0.0006296168,0.0315700586,0.0123984358,0.0009595916,0.0009746383,0.0049990761,0.0008657759,0.0017132332,0.2938075872)
C60pi4 = c(0.2227229348,0.0064846074,0.0061206496,0.0007997588,0.1640285908,0.0051051888,0.0027280806,0.0202702520,0.0037183875,0.0455406072,0.0883350071,0.0022832871,0.0348094559,0.0228667054,0.0035471579,0.0850040072,0.1012848285,0.0048424833,0.0096500033,0.1698580069)
C60pi5 = c(0.0412139519,0.0067627055,0.0051067690,0.0017434391,0.0204715649,0.0057538477,0.0037263409,0.0069107492,0.0180293946,0.1154281623,0.1693562458,0.0042900270,0.0414066566,0.2239001858,0.0058416410,0.0149106129,0.0239548406,0.0332237129,0.1379349474,0.1200342049)
C60pi6 = c(0.0480550249,0.0308438053,0.0940628721,0.2084606133,0.0037801787,0.0747676701,0.1855184661,0.0191402239,0.0872162350,0.0094685435,0.0277340828,0.0375741243,0.0088308358,0.0196000958,0.0081267777,0.0439680761,0.0324588883,0.0034665720,0.0387499964,0.0181769181)
C60pi7 = c(0.0062848745,0.0026246919,0.0030342510,0.0005324147,0.0073027627,0.0034409089,0.0009741492,0.0019578159,0.0102225186,0.0180592309,0.1179064681,0.0016205916,0.0234721825,0.3974552519,0.0020165583,0.0056903327,0.0037091821,0.0598639097,0.3185565304,0.0152753744)
C60pi8 = c(0.1815005560,0.0026845411,0.0148484537,0.0025145485,0.4205633920,0.0014097001,0.0007088144,0.0461854175,0.0014374605,0.0041745536,0.0098310464,0.0006474254,0.0041611385,0.0068976432,0.0038767247,0.1864537050,0.0687189855,0.0027083549,0.0061033012,0.0345742379)
C60pi9 = c(0.0600740822,0.0367642654,0.0134869242,0.0170572285,0.0070719770,0.0142469806,0.0127486975,0.0343564471,0.0305859029,0.0204571345,0.0994551128,0.0212367087,0.0318165939,0.1140907926,0.0297628218,0.0505792699,0.0339368402,0.2312808862,0.1192491702,0.0217421638)
C60pi10 = c(0.0708394513,0.0474098489,0.0416822304,0.0324482918,0.0131641265,0.0494874703,0.0508264389,0.0183309196,0.0567272697,0.0650369079,0.1282255556,0.0343618389,0.0390362930,0.0594359563,0.0135608209,0.0551343199,0.0642260358,0.0137118382,0.0673934289,0.0789609573)
C60pi11 = c(0.0617689371,0.0076332888,0.0303081645,0.3430234188,0.0007199837,0.0307856241,0.3792509407,0.0284658686,0.0079592120,0.0016999627,0.0039945339,0.0216076877,0.0019734329,0.0009814186,0.0174791407,0.0337831940,0.0203426591,0.0006130268,0.0017102752,0.0058992300)
C60pi12 = c(0.0421559537,0.1042068314,0.0286980872,0.0164385240,0.0044450330,0.1393690851,0.0531949072,0.0134711207,0.0177764997,0.0267727728,0.1967237776,0.1323735242,0.1182827521,0.0086728324,0.0051837880,0.0255852718,0.0333292020,0.0045852327,0.0070281498,0.0217066546)
C60pi13 = c(0.2814809927,0.0100367066,0.0172867775,0.0064385734,0.0258337508,0.0133101925,0.0115046410,0.0270054934,0.0054629657,0.0188216093,0.0190993462,0.0098712843,0.0158719589,0.0050481705,0.0129510033,0.1886808600,0.2427104979,0.0012274627,0.0036052922,0.0837524211)
C60pi14 = c(0.2769188320,0.0017226995,0.0021315271,0.0011672545,0.0318292645,0.0018216251,0.0024752467,0.0199646887,0.0005170863,0.0983109006,0.0489264326,0.0016232163,0.0173414948,0.0070843906,0.0070179705,0.0336348952,0.0814141404,0.0007118144,0.0032942319,0.3620922883)
C60pi15 = c(0.1577797792,0.1112140270,0.0570403237,0.0648290471,0.0053318076,0.1065373681,0.0913586945,0.0906209718,0.0533809635,0.0029171632,0.0156225571,0.0782148712,0.0045758969,0.0025047816,0.0067077844,0.0929310045,0.0393122597,0.0028575821,0.0077590269,0.0085040899)
C60pi16 = c(0.0593735135,0.0354740772,0.1151175314,0.2189482708,0.0015332173,0.0688752402,0.1819422913,0.0813707101,0.0220478285,0.0020993577,0.0056191259,0.0750172075,0.0021871739,0.0010838321,0.0109737422,0.0726449461,0.0380238271,0.0007346460,0.0026664883,0.0042669729)
C60pi17 = c(0.0978066326,0.0265576438,0.0101843505,0.0120781428,0.0064138404,0.0307876446,0.0291282947,0.0128912798,0.0128036716,0.0723904209,0.1279438950,0.0245630658,0.0303267312,0.0198963719,0.2723524069,0.0350549441,0.0484557340,0.0046842467,0.0104773833,0.1152032995)
C60pi18 = c(0.0124023388,0.0030680354,0.0009239105,0.0006037316,0.0041885695,0.0032957441,0.0012524000,0.0011306791,0.0013542104,0.2344167852,0.4550557697,0.0016718177,0.0667307666,0.0610615367,0.0037076169,0.0019420934,0.0067612939,0.0038937184,0.0074911765,0.1290478057)
C60pi19 = c(0.0794230623,0.1294739355,0.0662792725,0.0587236242,0.0019919499,0.1143880588,0.1246900644,0.0325432311,0.0238605372,0.0036277150,0.0097987961,0.2147597316,0.0041846209,0.0012869951,0.0142410239,0.0615807386,0.0477333594,0.0006525371,0.0029420233,0.0078187231)
C60pi20 = c(0.0248148778,0.0083552910,0.1888915388,0.4278832998,0.0027839717,0.0210777725,0.1432386297,0.0643968435,0.0185736870,0.0022506941,0.0034558626,0.0179274104,0.0015714503,0.0014680353,0.0073768035,0.0377003132,0.0187767966,0.0005891859,0.0042602708,0.0046072655)
C60pi21 = c(0.0017003427,0.0060674330,0.0004222900,0.0010711490,0.0029059420,0.0016424179,0.0011731741,0.0035579609,0.0027630465,0.0012291190,0.0127420810,0.0004273804,0.0025671348,0.0513377024,0.0013536738,0.0011871674,0.0014033068,0.8640436936,0.0390912582,0.0033137266)
C60pi22 = c(0.0468360682,0.0639796924,0.0205603686,0.0185615516,0.0059954138,0.0557030821,0.0705436036,0.0045435329,0.0152062773,0.1550613356,0.0824253382,0.0866248354,0.0245854443,0.0080177192,0.0081485616,0.0237025617,0.0962054496,0.0018368673,0.0067131723,0.2047491243)
C60pi23 = c(0.0258764792,0.0201097124,0.0298384107,0.0107037437,0.0142503909,0.0158529432,0.0105649532,0.0073064999,0.1411078834,0.0114777629,0.0407992414,0.0119179202,0.0098798997,0.1876429961,0.0051228805,0.0275699644,0.0170764901,0.0405124999,0.3536390834,0.0187502449)
C60pi24 = c(0.0296285022,0.0046400334,0.0034944393,0.0008851024,0.0090046468,0.0055481111,0.0033046518,0.0027969482,0.0050701500,0.2583397750,0.2668085481,0.0046690936,0.0770825277,0.0408798247,0.0026918193,0.0068538089,0.0322265673,0.0035506055,0.0153353414,0.2271895033)
C60pi25 = c(0.0555725806,0.0098447861,0.0409064430,0.0140389597,0.0097418602,0.0068727710,0.0069443190,0.0157956555,0.0041631258,0.0069826497,0.0075271247,0.0139224817,0.0058762687,0.0034496730,0.0119733364,0.3482466393,0.4213655981,0.0010061491,0.0026576772,0.0131119012)
C60pi26 = c(0.0682671212,0.0615207091,0.0530661192,0.0360278709,0.0141433148,0.0612274332,0.0497415394,0.0268696520,0.1127674983,0.0132646615,0.0544493838,0.0482609047,0.0170033964,0.0803375967,0.0191949850,0.0671839752,0.0443995774,0.0199957919,0.1255070748,0.0267713947)
C60pi27 = c(0.0792618808,0.0638377192,0.0635289371,0.0436646174,0.0049503302,0.0666365188,0.0829639117,0.0183428565,0.0233169239,0.0249427251,0.0221483402,0.0932577596,0.0120893380,0.0049131149,0.0126360122,0.1334848656,0.1916745928,0.0018040086,0.0062353115,0.0503102360)
C60pi28 = c(0.0731759112,0.2105335985,0.0324200854,0.0110007149,0.0123458504,0.0858951989,0.0349942684,0.0224509173,0.0386903280,0.0246226304,0.0508307349,0.1783344831,0.0185740720,0.0093148787,0.0148722772,0.0603181436,0.0649574934,0.0051046395,0.0130597421,0.0385040321)
C60pi29 = c(0.0878402710,0.0110331750,0.0060801213,0.0032803903,0.0171147088,0.0109831614,0.0101465790,0.0087090941,0.0054902234,0.1987761871,0.1756460821,0.0082096925,0.0417232903,0.0191954435,0.0111283542,0.0209862621,0.0697718709,0.0031744014,0.0081905473,0.2825201446)
C60pi30 = c(0.0990215820,0.0349351987,0.0211149501,0.0118797946,0.0108995677,0.0557710676,0.0278999992,0.0240250097,0.0123445071,0.0776564721,0.2354511299,0.0322817789,0.1207665429,0.0214442058,0.0075655541,0.0524170141,0.0649785115,0.0047075806,0.0077328724,0.0771066610)
C60pi31 = c(0.0601641168,0.0161995226,0.2783522747,0.0337188808,0.0315066987,0.0210645987,0.0059839451,0.0543080710,0.0531523512,0.0070650825,0.0070698142,0.0139598368,0.0088298653,0.0069525877,0.0075834331,0.2829802556,0.0860317092,0.0014966551,0.0134849454,0.0100953553)
C60pi32 = c(0.0049781737,0.0018412331,0.0007012207,0.0005315368,0.0052978737,0.0024089907,0.0007630546,0.0015051317,0.0041575221,0.0443828633,0.4417417476,0.0011615060,0.0602807417,0.3351117140,0.0027847686,0.0025795769,0.0030288544,0.0171302592,0.0458455751,0.0237676560)
C60pi33 = c(0.0251996593,0.1114468110,0.0142031925,0.0041012288,0.0097099500,0.0620070749,0.0262571641,0.0038067269,0.0431938935,0.0974043253,0.2447197423,0.0824312856,0.0539323021,0.0429091639,0.0052658505,0.0096093107,0.0251183002,0.0146571900,0.0456965140,0.0783303143)
C60pi34 = c(0.0230361648,0.0014748749,0.0013534390,0.0006264439,0.0048580122,0.0009870046,0.0015762583,0.0011565336,0.0008899238,0.3952895890,0.0576537208,0.0014663528,0.0140986541,0.0072127040,0.0020177885,0.0028770237,0.0205580852,0.0005477695,0.0019539080,0.4603657493)
C60pi35 = c(0.1408776963,0.0297808449,0.0171297613,0.0285076933,0.0032213718,0.0320632225,0.0423838922,0.0299558472,0.0131321477,0.0066914481,0.0195120028,0.0383781635,0.0036276863,0.0041231064,0.4383466229,0.0851400095,0.0422765692,0.0013236871,0.0037087638,0.0198194632)
C60pi36 = c(0.4442491220,0.0050216551,0.0102305117,0.0057193038,0.0235405374,0.0055997640,0.0064889886,0.0822687710,0.0025505743,0.0033615104,0.0040990063,0.0038097073,0.0028683069,0.0024413211,0.0162890960,0.2999969708,0.0559664935,0.0007735426,0.0020639824,0.0226608347)
C60pi37 = c(0.0898717958,0.0070958305,0.0130067619,0.0129166888,0.0044131479,0.0023806547,0.0058957027,0.8087563021,0.0016517855,0.0004339282,0.0015564455,0.0033939025,0.0004253422,0.0008073572,0.0034128140,0.0362876891,0.0032887534,0.0015223902,0.0008537454,0.0020289624)
C60pi38 = c(0.0550840246,0.0472254260,0.1877829604,0.1273796123,0.0035824944,0.0527969268,0.0655884730,0.0637607521,0.0404883483,0.0075574152,0.0136304510,0.0867682792,0.0081684229,0.0040375032,0.0110681809,0.1263380956,0.0752544318,0.0013563681,0.0118590434,0.0102727908)
C60pi39 = c(0.0117681394,0.0442558806,0.0844144627,0.0144712108,0.0070388254,0.1038342049,0.0110901161,0.0049626578,0.4337194047,0.0061337038,0.0298794939,0.0137928558,0.0076237551,0.0338266335,0.0081346096,0.0140571089,0.0108276801,0.0080683065,0.1437251732,0.0083757773)
C60pi40 = c(0.0159285638,0.0048098656,0.0032692643,0.0010966937,0.0080519916,0.0134552459,0.0021324215,0.0025086365,0.0049192147,0.0501543893,0.5307634291,0.0035599431,0.2160085187,0.0743650717,0.0045247350,0.0066922196,0.0119092283,0.0070928134,0.0106565111,0.0281012433)
C60pi41 = c(0.0195973253,0.0105142992,0.3289103336,0.3099848991,0.0034539049,0.0116196758,0.0250777800,0.0627528956,0.0295961112,0.0032650434,0.0028246884,0.0240963907,0.0008425062,0.0019706550,0.0049062781,0.1064984500,0.0438053705,0.0006333959,0.0056197958,0.0040302013)
C60pi42 = c(0.0833804360,0.0125871438,0.0969824220,0.0686820704,0.0081981143,0.0121520930,0.0227415415,0.0982291876,0.0073954898,0.0017471177,0.0039653113,0.0129342146,0.0019557975,0.0024132583,0.0355924232,0.3115606483,0.2113368612,0.0016329034,0.0017991083,0.0047138579)
C60pi43 = c(0.0181409133,0.4129662563,0.0233205154,0.0033333547,0.0085143598,0.0526694251,0.0096531879,0.0224552642,0.0375238929,0.0035090482,0.0149146621,0.3208065790,0.0046098856,0.0035426859,0.0087197469,0.0262309419,0.0131791136,0.0034766995,0.0079588201,0.0044746474)
C60pi44 = c(0.2494227404,0.0185481724,0.0164119567,0.0169234299,0.0122862654,0.0228501981,0.0370491083,0.0347467705,0.0087069587,0.0595718359,0.0451065029,0.0177064733,0.0204556127,0.0077360919,0.0686403544,0.0889295672,0.0986017356,0.0028603862,0.0061938477,0.1672519917)
C60pi45 = c(0.1419737638,0.0373945961,0.0576296888,0.0537452477,0.0068856658,0.0286239972,0.0407540287,0.3988107872,0.0152895617,0.0016627616,0.0092348297,0.0314273807,0.0055425500,0.0040286132,0.0180328866,0.1123731997,0.0242478202,0.0025909098,0.0049054208,0.0048462908)
C60pi46 = c(0.0178903305,0.1958843646,0.0155853897,0.0031054277,0.0290304227,0.1051819261,0.0040503389,0.0100480293,0.1252696215,0.0016708003,0.0722356645,0.0233340169,0.0116142354,0.0238913260,0.0009938415,0.0181675536,0.0186260222,0.2260554691,0.0859787232,0.0113864962)
C60pi47 = c(0.1454758367,0.0420979067,0.0400419720,0.1294249748,0.0014186329,0.0906469055,0.2471353458,0.0319650773,0.0130426183,0.0058525371,0.0123593139,0.0818154090,0.0044178939,0.0017552077,0.0151135525,0.0656688174,0.0511289472,0.0007731441,0.0029258438,0.0169400635)
C60pi48 = c(0.0169799462,0.0242346701,0.1318047919,0.1043655101,0.0022087215,0.0269349684,0.0376379591,0.5404470183,0.0181137053,0.0007459679,0.0021146994,0.0508617611,0.0009473769,0.0006780593,0.0038754401,0.0297030159,0.0045836180,0.0006031889,0.0015704090,0.0015891728)
C60pi49 = c(0.0402646249,0.1152022601,0.0323829165,0.0293968352,0.0039388655,0.2497008043,0.1603524245,0.0129260411,0.0617967839,0.0098491259,0.0354918823,0.1448804422,0.0124818865,0.0041153375,0.0043374229,0.0243246958,0.0305645368,0.0026676598,0.0097227847,0.0156026694)
C60pi50 = c(0.2256914610,0.0523417493,0.0244308734,0.0637125217,0.0043390149,0.0578159236,0.1154830640,0.0867335173,0.0131066949,0.0085086217,0.0193314218,0.0660468804,0.0064877206,0.0027440054,0.0611149102,0.1070877179,0.0507677144,0.0013695913,0.0028982948,0.0299883012)
C60pi51 = c(0.0033164209,0.0015310773,0.0030830171,0.0008266472,0.0051890730,0.0011024889,0.0005134130,0.0010432830,0.0278451262,0.0041895268,0.0111212494,0.0007149922,0.0023621780,0.3801761447,0.0008365077,0.0035876698,0.0023608948,0.0333346985,0.5107889643,0.0060766272)
C60pi52 = c(0.1995014012,0.0236078675,0.0392254543,0.0094955104,0.0584590451,0.0254265363,0.0125535371,0.0939787338,0.0341857201,0.0140209879,0.0449387571,0.0118723304,0.0246990633,0.0634433944,0.0145385320,0.1663920640,0.0533159207,0.0129802666,0.0606346163,0.0367302614)
C60pi53 = c(0.0319448994,0.1011667268,0.2084709220,0.0378074649,0.0066040348,0.0766372935,0.0279488190,0.0365541130,0.2088643258,0.0047542347,0.0156545731,0.0868664783,0.0043253317,0.0108915768,0.0060899575,0.0577656939,0.0302051160,0.0026001883,0.0387897304,0.0060585202)
C60pi54 = c(0.0776799515,0.0142518583,0.0403216692,0.0080651725,0.0140092962,0.0179995517,0.0112622427,0.0136868237,0.0133729897,0.1239635380,0.0724670993,0.0129144967,0.0420745442,0.0173584908,0.0117084432,0.0922723571,0.2316899445,0.0028153633,0.0141726542,0.1679135132)
C60pi55 = c(0.1183662657,0.0805192606,0.0259524932,0.0495595439,0.0035624835,0.1204924917,0.1537589210,0.0194993426,0.0229373171,0.0302661211,0.0571250629,0.0982304112,0.0171727472,0.0068665705,0.0175153030,0.0486588400,0.0635796210,0.0023008307,0.0083027431,0.0553336300)
C60pi56 = c(0.0528559899,0.0193569043,0.0264743774,0.2092761515,0.0008625883,0.1212409715,0.4024189781,0.0155838458,0.0124148798,0.0054864832,0.0090256472,0.0497017031,0.0042357114,0.0012650715,0.0063185636,0.0197262901,0.0235463735,0.0008381610,0.0033948741,0.0159764347)
C60pi57 = c(0.0344366215,0.0426221820,0.1636716191,0.1139007491,0.0020985982,0.0605413987,0.0541780220,0.3361639671,0.0461776737,0.0003463416,0.0048355678,0.0667552967,0.0019704509,0.0031557619,0.0040369775,0.0481173332,0.0089148085,0.0006510101,0.0054145649,0.0020110555)
C60pi58 = c(0.1153088951,0.0151278638,0.0458476603,0.1755516676,0.0014962362,0.0366731222,0.1749410045,0.0394181311,0.0132401530,0.0056912974,0.0101409559,0.0433118387,0.0030332064,0.0015700232,0.1665802563,0.0871536033,0.0468260603,0.0007515702,0.0031432715,0.0141931831)
C60pi59 = c(0.3865149348,0.0037579334,0.0030420497,0.0022366810,0.0218928357,0.0021464743,0.0031387843,0.3694353983,0.0014672902,0.0085376076,0.0127257242,0.0018840458,0.0080581695,0.0039281367,0.0158688291,0.0808877279,0.0305195935,0.0009922880,0.0019020345,0.0410634615)
C60pi60 = c(0.0146570745,0.0028841333,0.0012998335,0.0005210575,0.0024317913,0.0049362750,0.0014874369,0.0020953252,0.0010181940,0.1913901476,0.4432797758,0.0022898369,0.2217427062,0.0091637503,0.0007685153,0.0027251487,0.0170997497,0.0008779380,0.0014756028,0.0778557075)
catlist = rbind(C60pi1,C60pi2,C60pi3,C60pi4,C60pi5,C60pi6,C60pi7,C60pi8,C60pi9,C60pi10, C60pi11,C60pi12,C60pi13,C60pi14,C60pi15,C60pi16,C60pi17,C60pi18,C60pi19,C60pi20, C60pi21,C60pi22,C60pi23,C60pi24,C60pi25,C60pi26,C60pi27,C60pi28,C60pi29,C60pi30, C60pi31,C60pi32,C60pi33,C60pi34,C60pi35,C60pi36,C60pi37,C60pi38,C60pi39,C60pi40, C60pi41,C60pi42,C60pi43,C60pi44,C60pi45,C60pi46,C60pi47,C60pi48,C60pi49,C60pi50, C60pi51,C60pi52,C60pi53,C60pi54,C60pi55,C60pi56,C60pi57,C60pi58,C60pi59,C60pi60)
View(catlist)
install.packages("httpgd")
install.packages("phytools")
install.packages(c("brew", "broom", "cli", "clipr", "colorspace", "commonmark", "crayon", "desc", "dplyr", "evaluate", "fansi", "generics", "ggfun", "glue", "magrittr", "openssl", "pillar", "Rcpp", "readr", "rlang", "rmarkdown", "styler", "systemfonts", "tidyr", "tidyselect", "tidytree", "tinytex", "uuid", "waldo", "withr", "xfun", "yaml"))
install.packages("ape")
install.packages("ape")
16147-16324
2872-3071
12544-12696
9427-9554
205-425
20693-20900
35387-35536
5529-5741
4121-4287
20901-21132
6541-7810
8441-8687
36853-3717
11366-11577
27638-28142
41430-41531
34952-35072
11959-12106
11578-11958
15287-15511
21133-21226
32604-32898
26355-26559
19644-19962
36557-36720
8121-8219
32957-33175
26664-2698
46675-46873
31381-31757
35537-35751
40110-40275
32899-32956
5162-5445
23826-23944
28143-28374
48050-48164
37725-37941
33649-33823
28773-28974
3072-3208
3731-3878
38967-39191
9682-9838
48733-48983
23262-23399
12697-13752
47356-47471
16926-17502
3975-4120
29933-30108
2187-2713
47190-47355
28645-28772
4989-5161
51893-52063
41029-41173
12203-12543
25759-26354
37175-37724
669-905
906-1436
12107-12202
7988-8120
51740-51892
21584-22073
26983-27551
45789-45910
40450-40927
45146-45788
13753-13957
5446-5528
15512-15739
34252-34658
1572-1708
48984-49205
14161-14360
50053-50774
22074-22761
30536-30949
4626-4822
43005-43387
27552-27637
41174-41429
29868-29932
1709-1916
9935-10134
9555-9681
4288-4548
9839-9934
2796-2871
21227-21583
51472-51633
23612-23825
41644-41735
25658-25758
23945-24450
18474-18988
5742-6039
26560-26663
setwd("~/Desktop/nematode")
library(ggtree)
btrees <- read.tree("nematode_3tree")
ggtree(btrees) + geom_tiplab() + facet_grid()
import(ggplot)
library(ggplot2)
ggtree(btrees) + geom_tiplab() + facet_grid()
ggtree(btrees) + geom_tiplab() + facet_grid(ncols=3)
ggtree(btrees) + geom_tiplab() + facet_grid(~.id, ncol=10)
ggtree(btrees) + geom_tiplab() + facet_wrap(~.id, ncol=10)
ggtree(btrees) + geom_tiplab() + facet_wrap(~.id, ncol=10) + hexpand(0.5)
library(tidyr)
m <- read.table("m.txt")
View(m)
pivot_wider(m)
library(tidyr)
m <- read.table("m.txt")
tmp <- data.frame(x=gl(2,3, labels=letters[24:25]),
y=gl(3,1,6, labels=letters[1:3]),
z=c(1,2,3,3,3,2))
pivot_wider(m, names_from = )
View(tmp)
pivot_wider(m, names_from = V2, values_from = V3)
m2 <- pivot_wider(m, names_from = V2, values_from = V3)
library(tidyr)
m <- read.table("m.txt")
m2 <- pivot_wider(m, names_from = V2, values_from = V3)
View(m2)
clusters <- hclust(m2)
sapply(m2, var)
m2[9, ] <- sapply(m2, var)
cbind(m2, var = apply(m2, 1, function(x) var(na.omit(x))))
rbind(m2, var = apply(m2, 1, function(x) var(na.omit(x))))
rbind(m2, var = apply(m2[,2:21], 1, function(x) var(na.omit(x))))
rbind(m2, var = apply(m2[,2:21], 1, function(x) var())
)
sapply(m2, var)
sapply(m2, var)[2:21]
sapply(m2, var)
m2[9,] <- sapply(m2, var)
m2[9,] <- as.list(sapply(m2, var))
View(m2)
typeof(m2)
m2 %>% add_row(m2, sapply(m2, var))
library(tidyr)
library(tibble)
m <- read.table("m.txt")
m2 <- pivot_wider(m, names_from = V2, values_from = V3)
m2 %>% add_row(m2, sapply(m2, var))
sapply(m2, var)
length(sapply(m2, var))
length(sapply(m2, var))
m2 %>% add_row(m2, sapply(m2, var))
print(m2)
install.packages("ggtree")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtree")
setwd("~/Documents/GitHub/ATOLRootStudy/5_ScriptsNOTFINALIZED/1_FigureGeneration")
# Load packages.
library(ggplot2)
library(ggridges)
library(patchwork)
library(reshape2)
library(wesanderson)
# Function to generate a random normal distribution based on
# predicted mean and standard deviation of replicates from PPAs.
genppa <- function(x){
dist <- c(rnorm(500, mean=as.numeric(x[5]), sd=as.numeric(x[6])))
return(list(dist))
}
# Function to convert tabular PPA data into long format for ggplot.
longify <- function(x){
rl <- list()
for(row in 1:nrow(x)){
r <- x[row,]
l <- unlist(x[row,][8])
for (rep in l){
n <- c(r[1:7], rep)
names(n)[8] <- "Replicate"
rl[[length(rl)+1]] <- n
}
}
return(rl)
}
# File to be loaded in in the format:
# Dataset,Status,Statistic,Obs,Pred,SD,Replicates
# Chang2015,Original,PPA-DIV,4.07969,4.12583,0.00694512,500
p <- read.csv("ppas.csv", header=T)
# Generate normal distribution for each PPA results,
# then longify entire dataframe with individual replicates
# in distribution as values.
p$dist <- apply(p, 1, genppa)
d <- longify(p)
# Generate data frame, tidy up and factor columns.
f <- as.data.frame(do.call(rbind, d))
f$Obs <- as.numeric(f$Obs)
f$Pred <- as.numeric(f$Pred)
f$SD <- as.numeric(f$SD)
f$Replicates <- as.numeric(f$Replicates)
f$Replicate <- as.numeric(f$Replicate)
f$Status <- factor(f$Status, levels=(c("Original", "Filtered")))
f$Statistic <- factor(f$Statistic, levels=(c("PPA-DIV", "PPA-CONV", "PPA-VAR", "PPA-MAX", "PPA-MEAN")))
f$Dataset <- factor(f$Dataset, levels=c("Chang2015", "Whelan2015_D10", "Whelan2015_D20", "Simion2017", "Whelan2017_MCRS"))
# Generate Z-scores for each dataset, given observed and predicted mean and SD.
f$Z <- apply(f, 1, function(x){return((as.numeric(x[4]) - as.numeric(x[5]))/as.numeric(x[6]))})
# Generate PPA-DIV plots.
o <- subset(f, Statistic == "PPA-DIV")
g1 <- ggplot(o, aes(x=Replicate, y=Status, group=Status)) + geom_density_ridges(scale = 0.8, fill = "lightblue") +
geom_segment(aes(x = Obs, y = as.numeric(Status) + 0.2, xend = Obs, yend = Status),
colour = "red", stat = "unique", arrow = arrow(length = unit(0.2, "cm"))) +
geom_label(aes(x = Obs, y = as.numeric(Status) + 0.7,
label = paste0("|Z| = ", as.character(abs(round(Z, 2))))),
stat = "unique", colour = "black", hjust="inward") +
facet_grid(rows = vars(Statistic), cols = vars(Dataset), scales="free") +
theme_bw() +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(), axis.title.x=element_blank())
# Generate PPA-CONV plots.
o <- subset(f, Statistic == "PPA-CONV")
g2 <- ggplot(o, aes(x=Replicate, y=Status, group=Status)) + geom_density_ridges(scale = 0.8, fill = "lightblue") +
geom_segment(aes(x = Obs, y = as.numeric(Status) + 0.2, xend = Obs, yend = Status),
colour = "red", stat = "unique", arrow = arrow(length = unit(0.2, "cm"))) +
geom_label(aes(x = Obs, y = as.numeric(Status) + 0.7,
label = paste0("|Z| = ", as.character(abs(round(Z, 2))))),
stat = "unique", colour = "black", hjust="inward") +
facet_grid(rows = vars(Statistic), cols = vars(Dataset), scales="free") +
theme_bw() +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(), axis.title.x=element_blank())
# Generate PPA-VAR plots.
o <- subset(f, Statistic == "PPA-VAR")
g3 <- ggplot(o, aes(x=Replicate, y=Status, group=Status)) + geom_density_ridges(scale = 0.8, fill = "lightblue") +
geom_segment(aes(x = Obs, y = as.numeric(Status) + 0.2, xend = Obs, yend = Status),
colour = "red", stat = "unique", arrow = arrow(length = unit(0.2, "cm"))) +
geom_label(aes(x = Obs, y = as.numeric(Status) + 0.7,
label = paste0("|Z| = ", as.character(abs(round(Z, 2))))),
stat = "unique", colour = "black", hjust="inward") +
facet_grid(rows = vars(Statistic), cols = vars(Dataset), scales="free") +
theme_bw() +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(), axis.title.x=element_blank(),  strip.text.x = element_blank())
# Generate PPA-MAX plots.
o <- subset(f, Statistic == "PPA-MAX")
g4 <- ggplot(o, aes(x=Replicate, y=Status, group=Status)) + geom_density_ridges(scale = 0.8, fill = "lightblue") +
geom_segment(aes(x = Obs, y = as.numeric(Status) + 0.2, xend = Obs, yend = Status),
colour = "red", stat = "unique", arrow = arrow(length = unit(0.2, "cm"))) +
geom_label(aes(x = Obs, y = as.numeric(Status) + 0.7,
label = paste0("|Z| = ", as.character(abs(round(Z, 2))))),
stat = "unique", colour = "black", hjust="inward") +
facet_grid(rows = vars(Statistic), cols = vars(Dataset), scales="free") +
theme_bw() +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(), strip.text.x = element_blank()) +
labs(x = "Predicted range of simulated replicates")
# Generate PPA-MEAN plots.
o <- subset(f, Statistic == "PPA-MEAN")
g5 <- ggplot(o, aes(x=Replicate, y=Status, group=Status)) + geom_density_ridges(scale = 0.8, fill = "lightblue") +
geom_segment(aes(x = Obs, y = as.numeric(Status) + 0.2, xend = Obs, yend = Status),
colour = "red", stat = "unique", arrow = arrow(length = unit(0.2, "cm"))) +
geom_label(aes(x = Obs, y = as.numeric(Status) + 0.7,
label = paste0("|Z| = ", as.character(abs(round(Z, 2))))),
stat = "unique", colour = "black", hjust="inward") +
facet_grid(rows = vars(Statistic), cols = vars(Dataset), scales="free") +
theme_bw() +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(),  strip.text.x = element_blank()) +
labs(x = "Predicted range of simulated replicates")
# Generate colour palette.
w <- wes_palette(name="Zissou1", n=5)[2:5]
# Data from QMaker analysis to be read in as:
# Dataset	Q	LG	JTT	WAG	Status
# Chang2015	94	6	0	0	Original
d <- read.table("QMaker.tab", header=T)
# Factoring dataset and melting on Q, LG, JTT and WAG columns.
d$Dataset <- factor(d$Dataset, levels=c("Chang2015", "Whelan2015_D10", "Whelan2015_D20", "Simion2017", "Whelan2017_MCRS"))
d$Status <- factor(d$Status, levels=c("Original", "Filtered"))
m <- melt(d)
# Generate QMaker plot as faceted, stacked barchart.
g <- ggplot(m, aes(x=Status, y=value, fill=variable)) + geom_bar(position="fill", stat="identity", colour = "black") +
geom_text(data=subset(m, value > 1), aes(x=Status, y=value, label=value), size=6, colour = "black", position=position_fill(vjust = 0.5)) +
facet_grid(cols = vars(Dataset)) + theme_bw() + scale_fill_manual(values=w) +
theme(panel.grid.minor = element_blank(), legend.title = element_blank(), axis.text.x=element_text(angle=45, hjust=1, size=10),axis.text.y=element_text(size=10)) +
labs(x = "Subset", y = "% of test OGs with best-fit substitution model (BIC)") + scale_y_continuous(labels = scales::percent)
# Plot PPA-DIV and MAX plots alongside QMaker plot.
plot(g1 / g4 | g) + plot_layout(widths = c(2,1))
# Plot other PPA results.
plot(g2 / g3 / g5)
plot(g1 / g4 | g) + plot_layout(widths = c(2,1))
